<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Diligent Engine: Render State Packager</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Diligent Engine
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d1/dea/DiligentTools_RenderStatePackager_README.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Render State Packager</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Render state packager is an off-line render state processing, optimization and packaging tool. It uses JSON-based render state description called <a class="el" href="../../d7/dca/namespaceDiligent.html" title="Graphics engine namespace.">Diligent</a> Render State Notation (DRSN). The states defined in a DRSN file are processed off-line and packaged into an archive in a format optimized for run-time loading performance.</p>
<h2><a class="anchor" id="autotoc_md490"></a>
Command Line Arguments</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Argument   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Default value    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>-o</code> (<code>output</code>)   </td><td class="markdownTableBodyNone">archive output file   </td><td class="markdownTableBodyNone"><code>Archive.bin</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>-s</code> (<code>shader_dir</code>)   </td><td class="markdownTableBodyNone">shader search drectory   </td><td class="markdownTableBodyNone"><code>.</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>-r</code> (<code>render_state_dir</code>)   </td><td class="markdownTableBodyNone">render states search directory   </td><td class="markdownTableBodyNone"><code>.</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>-c</code> (<code>config</code>)   </td><td class="markdownTableBodyNone">config file   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>-t</code> (<code>thread</code>)   </td><td class="markdownTableBodyNone">thread Count   </td><td class="markdownTableBodyNone"><a class="el" href="../../d6/d27/namespaceSystem.html">System</a> CPU count    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>-i</code> (<code>input</code>)   </td><td class="markdownTableBodyNone">input DRSN file (Required)   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>-d</code> (<code>dump_dir</code>)   </td><td class="markdownTableBodyNone">bytecode dump directory   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>strip_reflection</code>   </td><td class="markdownTableBodyNone">strip reflection information when packing shaders into the archive   </td><td class="markdownTableBodyNone">No   </td></tr>
</table>
<p>Device Flags (at least one flag is required):</p><ul>
<li><code>--dx11</code></li>
<li><code>--dx12</code></li>
<li><code>--vulkan</code></li>
<li><code>--opengl</code></li>
<li><code>--opengles</code></li>
<li><code>--metal_macos</code></li>
<li><code>--metal_ios</code></li>
</ul>
<p>Flags not supported on the platform (for example, <code>--metal_macos</code> on Windows or Linux) are ignored.</p>
<p>Example:</p>
<div class="fragment"><div class="line">Diligent-RenderStatePackager.exe -o Archive.bin --vulkan --dx12 -c Config.json -s . -i SamplePSO_0.drsn -i SamplePSO_1.drsn</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md491"></a>
Render State Notation</h2>
<p>DRSN is a JSON-based description that mirrors core structures. The JSON file consists of three main sections:</p>
<ul>
<li><em>Shaders</em> sections defines shaders</li>
<li><em>ResourceSignatures</em> section contains the descriptions of pipeline resource signatures</li>
<li><em>Pipeleines</em> section describes pipeline states</li>
</ul>
<p><b>Important</b>: all shader, signature and pipeline resource names in an archive must be unique.</p>
<p>Example of a DRSN file:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    &quot;ResourceSignatures&quot;: [</div>
<div class="line">        {</div>
<div class="line">            &quot;Name&quot;: &quot;Signature0&quot;,</div>
<div class="line">            &quot;Resources&quot;: [</div>
<div class="line">                {</div>
<div class="line">                    &quot;Name&quot;: &quot;Constants&quot;,</div>
<div class="line">                    &quot;ShaderStages&quot;: [</div>
<div class="line">                        &quot;VERTEX&quot;,</div>
<div class="line">                        &quot;PIXEL&quot;</div>
<div class="line">                    ],</div>
<div class="line">                    &quot;VarType&quot;: &quot;DYNAMIC&quot;,</div>
<div class="line">                    &quot;ResourceType&quot;: &quot;CONSTANT_BUFFER&quot;,</div>
<div class="line">                    &quot;Flags&quot;: [&quot;NO_DYNAMIC_BUFFERS&quot;]</div>
<div class="line">                }</div>
<div class="line">            ],</div>
<div class="line">            &quot;ImmutableSamplers&quot;: [</div>
<div class="line">                {</div>
<div class="line">                    &quot;ShaderStages&quot;: [&quot;PIXEL&quot;],</div>
<div class="line">                    &quot;SamplerOrTextureName&quot;: &quot;LinearSampler&quot;,</div>
<div class="line">                    &quot;Desc&quot;: {</div>
<div class="line">                        &quot;BorderColor&quot; : [1.0, 1.0, 1.0, 1.0]</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            ]</div>
<div class="line">        }</div>
<div class="line">    ],</div>
<div class="line">    &quot;Shaders&quot;: [</div>
<div class="line">        {</div>
<div class="line">            &quot;Desc&quot;: {</div>
<div class="line">                &quot;Name&quot;: &quot;My vertex shader&quot;,</div>
<div class="line">                &quot;ShaderType&quot;: &quot;VERTEX&quot;</div>
<div class="line">            },</div>
<div class="line">            &quot;SourceLanguage&quot;: &quot;HLSL&quot;,</div>
<div class="line">            &quot;FilePath&quot;: &quot;VertexShader.vsh&quot;,</div>
<div class="line">            &quot;EntryPoint&quot;: &quot;VSmain&quot;,</div>
<div class="line">            &quot;UseCombinedTextureSamplers&quot;: true,</div>
<div class="line">            &quot;Macros&quot;: [</div>
<div class="line">                {&quot;Name&quot;: &quot;MY_MACRO_0&quot;, &quot;Definition&quot;: &quot;0&quot;}</div>
<div class="line">            ]</div>
<div class="line">        },</div>
<div class="line">        {</div>
<div class="line">            &quot;Desc&quot;: {</div>
<div class="line">                &quot;Name&quot;: &quot;My pixel shader&quot;,</div>
<div class="line">                &quot;ShaderType&quot;: &quot;PIXEL&quot;</div>
<div class="line">            },</div>
<div class="line">            &quot;SourceLanguage&quot;: &quot;HLSL&quot;,</div>
<div class="line">            &quot;FilePath&quot;: &quot;MyPixelShader.psh&quot;,</div>
<div class="line">            &quot;EntryPoint&quot;: &quot;PSmain&quot;,</div>
<div class="line">            &quot;UseCombinedTextureSamplers&quot;: true</div>
<div class="line">        }</div>
<div class="line">    ],</div>
<div class="line">    &quot;Pipeleines&quot;: [</div>
<div class="line">        {</div>
<div class="line">            &quot;PSODesc&quot;: {</div>
<div class="line">                &quot;Name&quot;: &quot;My PSO 0&quot;,</div>
<div class="line">                &quot;PipelineType&quot;: &quot;GRAPHICS&quot;</div>
<div class="line">            },</div>
<div class="line">            &quot;GraphicsPipeline&quot;: {</div>
<div class="line">                &quot;DepthStencilDesc&quot;: {</div>
<div class="line">                    &quot;DepthEnable&quot;: false</div>
<div class="line">                },</div>
<div class="line">                &quot;InputLayout&quot;: {</div>
<div class="line">                    &quot;LayoutElements&quot;: [</div>
<div class="line">                        {</div>
<div class="line">                            &quot;NumComponents&quot;: 3</div>
<div class="line">                        },</div>
<div class="line">                        {</div>
<div class="line">                            &quot;InputIndex&quot;: 1,</div>
<div class="line">                            &quot;NumComponents&quot;: 4</div>
<div class="line">                        }</div>
<div class="line">                    ]</div>
<div class="line">                },</div>
<div class="line">                &quot;NumRenderTargets&quot;: 1,</div>
<div class="line">                &quot;RTVFormats&quot;: {</div>
<div class="line">                    &quot;0&quot;: &quot;RGBA8_UNORM_SRGB&quot;</div>
<div class="line">                },</div>
<div class="line">                &quot;RasterizerDesc&quot;: {</div>
<div class="line">                    &quot;CullMode&quot;: &quot;FRONT&quot;</div>
<div class="line">                },</div>
<div class="line">                &quot;BlendDesc&quot;: {</div>
<div class="line">                    &quot;RenderTargets&quot;: {</div>
<div class="line">                        &quot;0&quot;: {</div>
<div class="line">                            &quot;BlendEnable&quot;: true</div>
<div class="line">                        }</div>
<div class="line">                    }</div>
<div class="line">                }</div>
<div class="line">            },</div>
<div class="line">            &quot;ppResourceSignatures&quot;: [</div>
<div class="line">                &quot;Signature0&quot;</div>
<div class="line">            ],</div>
<div class="line">            &quot;pVS&quot;: &quot;My vertex shader&quot;,</div>
<div class="line">            &quot;pPS&quot;: &quot;My pixel shader&quot;</div>
<div class="line">        }</div>
<div class="line">    ]</div>
<div class="line">}</div>
</div><!-- fragment --><p>If shaders are used by a single pipeline state, they can be defined inline in the PSO description, for instance:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    &quot;Pipeleines&quot;: [</div>
<div class="line">        {</div>
<div class="line">            &quot;PSODesc&quot;: {</div>
<div class="line">                &quot;Name&quot;: &quot;My PSO 1&quot;,</div>
<div class="line">            },</div>
<div class="line">            &quot;GraphicsPipeline&quot;: {</div>
<div class="line">                &quot;RTVFormats&quot;: {</div>
<div class="line">                    &quot;0&quot;: &quot;RGBA8_UNORM_SRGB&quot;</div>
<div class="line">                },</div>
<div class="line">            },</div>
<div class="line">            &quot;pVS&quot;: {</div>
<div class="line">                &quot;Desc&quot;: {</div>
<div class="line">                    &quot;Name&quot;: &quot;My vertex shader&quot;</div>
<div class="line">                },</div>
<div class="line">                &quot;FilePath&quot;: &quot;VertexShader.vsh&quot;,</div>
<div class="line">                &quot;EntryPoint&quot;: &quot;VSmain&quot;</div>
<div class="line">            },</div>
<div class="line">            &quot;pPS&quot;: {</div>
<div class="line">                &quot;Desc&quot;: {</div>
<div class="line">                    &quot;Name&quot;: &quot;My pixel shader&quot;</div>
<div class="line">                },</div>
<div class="line">                &quot;FilePath&quot;: &quot;PixelShader.psh&quot;,</div>
<div class="line">                &quot;EntryPoint&quot;: &quot;PSmain&quot;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">        }</div>
<div class="line">    ]</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md492"></a>
Import Feature</h2>
<p>DRSN files may be imported into another files allowing sharing deifintions of common states, for example:</p>
<div class="fragment"><div class="line">Resources</div>
<div class="line">|   Diligent-RenderStatePackager.exe</div>
<div class="line">| ------ Shaders</div>
<div class="line">   |   Shader0.hlsl</div>
<div class="line">   |   Shader1.hlsl</div>
<div class="line">   |    ...</div>
<div class="line">| ------ RenderStates</div>
<div class="line">   |   RenderState0.json</div>
<div class="line">   |   RenderState1.json</div>
<div class="line">   |    ...</div>
<div class="line">   |   RenderStateN.json</div>
<div class="line">   |   RenderStatesLib.json</div>
</div><!-- fragment --><div class="fragment"><div class="line">// RenderStatesLib.json</div>
<div class="line">{</div>
<div class="line">   </div>
<div class="line">    &quot;Imports&quot;: [</div>
<div class="line">        &quot;RenderState0.json&quot;,</div>
<div class="line">        &quot;RenderState1.json&quot;,</div>
<div class="line">        ....</div>
<div class="line">        &quot;RenderStateN.json&quot;</div>
<div class="line">    ]</div>
<div class="line">    ...</div>
<div class="line">}</div>
</div><!-- fragment --><p>Use <code>-r</code> command line option to define the render state notation search path(s):</p>
<div class="fragment"><div class="line">Diligent-RenderStatePackager.exe -s ./Shaders -r ./RenderStates -i RenderStatesLib.drsn --vulkan</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md493"></a>
Defaults</h2>
<p>Render state notation file may contain <code>Defaults</code> section that defines the default values for shaders, pipeline states and signatures, for example:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    &quot;Defaults&quot;: {</div>
<div class="line">        &quot;Shader&quot;: {</div>
<div class="line">            &quot;SourceLanguage&quot;: &quot;HLSL&quot;,</div>
<div class="line">            &quot;UseCombinedTextureSamplers&quot;: true</div>
<div class="line">        },</div>
<div class="line">        &quot;Pipeline&quot;: {</div>
<div class="line">            &quot;PSODesc&quot;: {</div>
<div class="line">                &quot;ResourceLayout&quot;: {</div>
<div class="line">                    &quot;DefaultVariableType&quot;: &quot;MUTABLE&quot;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    },</div>
<div class="line">    &quot;Pipelines&quot;: [</div>
<div class="line">    ],</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md494"></a>
Packager Configuration</h2>
<p>Render state packager configuration mirrors the fields of the <code>SerializationDeviceCreateInfo</code> struct.</p>
<p>Example config file:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    &quot;Vulkan&quot;: {</div>
<div class="line">        &quot;Version&quot;: { &quot;Major&quot;: 1, &quot;Minor&quot;: 2 },</div>
<div class="line">        &quot;SupportsSpirv14&quot;: true,</div>
<div class="line">        &quot;DxCompilerPath&quot;: &quot;PATH_TO_COMPILER&quot;</div>
<div class="line">    },</div>
<div class="line">    &quot;Metal&quot;: {</div>
<div class="line">        &quot;MslPreprocessorCmd&quot;: &quot;PREPROCESSOR_CMD&quot;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>Note: to enable shader debugging in XCode, use <code>-gline-tables-only -frecord-sources</code> command line options for Metal (<code>-frecord-sources</code> replaces <code>-MO</code> that was used in earlier versions of XCode):</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    &quot;Metal&quot;: {</div>
<div class="line">        &quot;CompileOptionsMacOS&quot;: &quot;-sdk macosx metal -gline-tables-only -frecord-sources&quot;,</div>
<div class="line">        &quot;CompileOptionsiOS&quot;: &quot;-sdk iphoneos metal -gline-tables-only -frecord-sources&quot;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.13.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
      <a href="https://diligentgraphics.com">
        <img class="footer" src="https://github.com/DiligentGraphics/DiligentCore/raw/master/media/diligentgraphics-logo.png" width="99" height="32" alt="Diligent Graphics" />
      </a>
    </li>
  </ul>
</div>
</body>
</html>
