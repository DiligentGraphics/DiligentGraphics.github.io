<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Diligent Engine: Graphics Engine D3D12</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Diligent Engine
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d2/dca/DiligentCore_Graphics_GraphicsEngineD3D12_readme.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Graphics Engine D3D12</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Implementation of Direct3D12 backend</p>
<h2><a class="anchor" id="autotoc_md63"></a>
Interoperability with Direct3D12</h2>
<p><a class="el" href="../../d7/dca/namespaceDiligent.html" title="Graphics engine namespace.">Diligent</a> Engine exposes methods to access internal Direct3D12 objects, is able to create diligent engine buffers and textures from existing Direct3D12 resources, and can be initialized by attaching to existing Direct3D12 device and provide synchronization tools.</p>
<h3><a class="anchor" id="autotoc_md64"></a>
Accessing Native Direct3D12 Resources</h3>
<p>Below are some of the methods that provide access to internal Direct3D12 objects:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Function   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>IBufferD3D12::GetD3D12Buffer(size_t&amp; DataStartByteOffset, ContextId)</code>   </td><td class="markdownTableBodyNone">returns a pointer to the <code>ID3D12Resource</code> interface of the internal Direct3D12 buffer object. Note that dynamic buffers are suballocated from dynamic heap, and every context has its own dynamic heap. Offset from the beginning of the dynamic heap for a context identified by <code>ContextId</code> is returned in <code>DataStartByteOffset</code> parameter    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>IBufferD3D12::SetD3D12ResourceState</code>   </td><td class="markdownTableBodyNone">sets the buffer usage state. This method should be used when an application transitions the buffer to inform the engine about the current usage state    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>IBufferD3D12::GetD3D12ResourceState</code>   </td><td class="markdownTableBodyNone">returns current Direct3D12 buffer state    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>IBufferViewD3D12::GetCPUDescriptorHandle</code>   </td><td class="markdownTableBodyNone">returns CPU descriptor handle of the buffer view    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>ITextureD3D12::GetD3D12Texture</code>   </td><td class="markdownTableBodyNone">returns a pointer to the <code>ID3D12Resource</code> interface of the internal Direct3D12 texture object    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>ITextureD3D12::SetD3D12ResourceState</code>   </td><td class="markdownTableBodyNone">sets the texture usage state. This method should be used when an application transitions the texture to inform the engine about the current usage state    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>ITextureD3D12::GetD3D12ResourceState</code>   </td><td class="markdownTableBodyNone">returns current Direct3D12 texture state    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>ITextureViewD3D12::GetCPUDescriptorHandle</code>   </td><td class="markdownTableBodyNone">returns CPU descriptor handle of the texture view    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>IDeviceContextD3D12::TransitionTextureState</code>   </td><td class="markdownTableBodyNone">transitions internal Direct3D12 texture object to the specified state    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>IDeviceContextD3D12::TransitionBufferState</code>   </td><td class="markdownTableBodyNone">transitions internal Direct3D12 buffer object to the specified state    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>IDeviceContextD3D12::GetD3D12CommandList</code>   </td><td class="markdownTableBodyNone">returns a pointer to Direct3D12 graphics command list that is currently being recorded    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>IPipelineStateD3D12::GetD3D12PipelineState</code>   </td><td class="markdownTableBodyNone">returns <code>ID3D12PipelineState</code> interface of the internal Direct3D12 pipeline state object object    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>IPipelineStateD3D12::GetD3D12RootSignature</code>   </td><td class="markdownTableBodyNone">returns a pointer to the root signature object associated with this pipeline state    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>IPipelineStateD3D12::GetD3D12StateObject</code>   </td><td class="markdownTableBodyNone">returns <code>ID3D12StateObject</code> interface of the internal D3D12 state object for ray tracing    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>ISamplerD3D12::GetCPUDescriptorHandle</code>   </td><td class="markdownTableBodyNone">returns a CPU descriptor handle of the Direct3D12 sampler object    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>IRenderDeviceD3D12::GetD3D12Device</code>   </td><td class="markdownTableBodyNone">returns <code>ID3D12Device</code> interface of the internal Direct3D12 device object    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>IFenceD3D12::GetD3D12Fence</code>   </td><td class="markdownTableBodyNone">returns <code>IFenceD3D12</code> interface of the internal fence object    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>IQueryD3D12::GetD3D12QueryHeap</code>   </td><td class="markdownTableBodyNone">returns the Direct3D12 query heap that internal query object resides in    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>IQueryD3D12::GetQueryHeapIndex</code>   </td><td class="markdownTableBodyNone">returns the index of a query object in Direct3D12 query heap    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>IBottomLevelASD3D12::GetD3D12BLAS</code>   </td><td class="markdownTableBodyNone">returns <code>ID3D12Resource</code> interface of the internal Direct3D12 BLAS object    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>ITopLevelASD3D12::GetD3D12TLAS</code>   </td><td class="markdownTableBodyNone">returns <code>ID3D12Resource</code> interface of the internal Direct3D12 TLAS object    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>ITopLevelASD3D12::GetCPUDescriptorHandle</code>   </td><td class="markdownTableBodyNone">returns a CPU descriptor handle of the D3D12 acceleration structure    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>IShaderBindingTableD3D12::GetD3D12BindingTable</code>   </td><td class="markdownTableBodyNone">returns the shader binding table structure that can be used with <code>ID3D12GraphicsCommandList4::DispatchRays</code> call    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>ISwapChainD3D12::GetDXGISwapChain</code>   </td><td class="markdownTableBodyNone">returns a pointer to the IDXGISwapChain interface of the internal DXGI object   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md65"></a>
Synchronization Tools</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Function   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>ICommandQueueD3D12::Submit</code>   </td><td class="markdownTableBodyNone">submits a Direct3D12 command lists for execution    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>ICommandQueueD3D12::GetD3D12CommandQueue</code>   </td><td class="markdownTableBodyNone">returns Direct3D12 command queue    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>ICommandQueueD3D12::EnqueueSignal</code>   </td><td class="markdownTableBodyNone">signals the Direct3D12 fence    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>ICommandQueueD3D12::WaitFence</code>   </td><td class="markdownTableBodyNone">waits for the Direct3D12 fence on the GPU   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md66"></a>
Creating Diligent Engine Objects from D3D12 Resources</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Function   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>IRenderDeviceD3D12::CreateTextureFromD3DResource</code>   </td><td class="markdownTableBodyNone">creates a <a class="el" href="../../d7/dca/namespaceDiligent.html" title="Graphics engine namespace.">Diligent</a> Engine texture object from the native Direct3D12 resource    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>IRenderDeviceD3D12::CreateBufferFromD3DResource</code>   </td><td class="markdownTableBodyNone">creates a <a class="el" href="../../d7/dca/namespaceDiligent.html" title="Graphics engine namespace.">Diligent</a> Engine buffer object from the native Direct3D12 resource. The method takes a pointer to the native Direct3D12 resource <code>pd3d12Buffer</code>, buffer description <code>BuffDesc</code> and writes a pointer to the <code>IBuffer</code> interface at the memory location pointed to by <code>ppBuffer</code>. The system can recover buffer size, but the rest of the fields of <code>BuffDesc</code> structure need to be populated by the client as they cannot be recovered from Direct3D12 resource description.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>IRenderDeviceD3D12::CreateBLASFromD3DResource</code>   </td><td class="markdownTableBodyNone">creates a <a class="el" href="../../d7/dca/namespaceDiligent.html" title="Graphics engine namespace.">Diligent</a> Engine bottom-level acceleration structure from the native Direct3D12 resource    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>IRenderDeviceD3D12::CreateTLASFromD3DResource</code>   </td><td class="markdownTableBodyNone">creates a <a class="el" href="../../d7/dca/namespaceDiligent.html" title="Graphics engine namespace.">Diligent</a> Engine top-level acceleration structure from the native Direct3D12 resource   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md67"></a>
Initializing the Engine by Attaching to Existing D3D12 Device</h3>
<p>To attach diligent engine to existing D3D12 device, use the following factory function:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> IEngineFactoryD3D12::AttachToD3D12Device(<span class="keywordtype">void</span>*                           pd3d12NativeDevice,</div>
<div class="line">                                              Uint32                          CommandQueueCount,</div>
<div class="line">                                              <span class="keyword">struct</span> ICommandQueueD3D12**     ppCommandQueues,</div>
<div class="line">                                              <span class="keyword">const</span> EngineD3D12CreateInfo REF EngineCI,</div>
<div class="line">                                              IRenderDevice**                 ppDevice,</div>
<div class="line">                                              IDeviceContext**                ppContexts);</div>
</div><!-- fragment --><p>The method takes a pointer to the native D3D12 device <code>pd3d12NativeDevice</code>, initialization parameters <code>EngineCI</code>, and returns the <a class="el" href="../../d7/dca/namespaceDiligent.html" title="Graphics engine namespace.">Diligent</a> Engine device in <code>ppDevice</code>, and contexts in <code>ppContexts</code> parameters. Pointers to the immediate contexts go first. If <code>EngineCI.NumDeferredContexts</code> &gt; 0, pointers to deferred contexts go afterwards. The function also takes an array of command queue objects <code>ppCommandQueues</code>, which need to implement <code>ICommandQueueD3D12</code> interface.</p>
<hr  />
<p><a href="http://diligentgraphics.com">diligentgraphics.com</a></p>
<p><a href="https://twitter.com/diligentengine"><img src="https://github.com/DiligentGraphics/DiligentCore/raw/master/media/twitter.png" alt="Diligent Engine on Twitter" class="inline"/></a> <a href="https://www.facebook.com/DiligentGraphics/"><img src="https://github.com/DiligentGraphics/DiligentCore/raw/master/media/facebook.png" alt="Diligent Engine on Facebook" class="inline"/></a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.13.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
      <a href="https://diligentgraphics.com">
        <img class="footer" src="https://github.com/DiligentGraphics/DiligentCore/raw/master/media/diligentgraphics-logo.png" width="99" height="32" alt="Diligent Graphics" />
      </a>
    </li>
  </ul>
</div>
</body>
</html>
