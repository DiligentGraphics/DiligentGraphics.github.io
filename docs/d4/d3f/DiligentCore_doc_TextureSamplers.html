<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Diligent Engine: Working with Texture Samplers</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Diligent Engine
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d4/d3f/DiligentCore_doc_TextureSamplers.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Working with Texture Samplers</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Implementations of texture samplers vary considerably in the native graphics APIs supported by <a class="el" href="../../d7/dca/namespaceDiligent.html" title="Graphics engine namespace.">Diligent</a> Engine. In Direct3D11, Direct3D12 and Metal, textures and samplers are decoupled and there are separate shader objects for each, for example:</p>
<div class="fragment"><div class="line">Texture2D    g_Texture;</div>
<div class="line">SamplerState g_Sampler;</div>
<div class="line"> </div>
<div class="line">// ...</div>
<div class="line"> </div>
<div class="line">float4 Color = g_Texture.Sample(g_Sampler, UV);</div>
</div><!-- fragment --><p>In OpenGL, samplers are combined with textures into a single shader object:</p>
<div class="fragment"><div class="line">uniform sampler2D g_Texture;</div>
<div class="line"> </div>
<div class="line">// ...</div>
<div class="line"> </div>
<div class="line">vec4 Color = texture(g_Texture, UV);</div>
</div><!-- fragment --><p>Vulkan supports both ways: there are both combined and separate samplers.</p>
<p>There are two ways texture samplers can be handled in <a class="el" href="../../d7/dca/namespaceDiligent.html" title="Graphics engine namespace.">Diligent</a> Engine, which are described in detail below.</p>
<h2><a class="anchor" id="autotoc_md31"></a>
Separate Samplers</h2>
<p>A more straightforward and clean way to work with texture samplers is to use separate samplers. This way is native to Direct3D11, Direct3D12 and Metal and is also fully supported by Vulkan. Separate samplers are only unavailable in OpenGL.</p>
<p>When separate samplers are used, every sampler is just a regular shader variable and is accessed similar to all other resources. Samplers follow the same conventions regarding variable types (static, mutable, dynamic), for example:</p>
<div class="fragment"><div class="line">RefCntAutoPtr&lt;ISampler&gt; pSampler;</div>
<div class="line">pDevice-&gt;CreateSampler(SamDesc, &amp;pSampler);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// ...</span></div>
<div class="line">pPSO-&gt;GetStaticVariableByName(SHADER_TYPE_PIXEL, <span class="stringliteral">&quot;g_StaticSampler&quot;</span>)-&gt;Set(pSampler);</div>
<div class="line">pSRB-&gt;GetVariableByName(SHADER_TYPE_PIXEL, <span class="stringliteral">&quot;g_MutableSampler&quot;</span>)-&gt;Set(pSampler);</div>
</div><!-- fragment --><p>Separate samplers are natively supported by HLSL and MSL. GLSL also supports separate samplers using the following syntax (Vulkan only):</p>
<div class="fragment"><div class="line">uniform sampler   uSampler;</div>
<div class="line">uniform texture2D uTexture;</div>
<div class="line"> </div>
<div class="line">// ...</div>
<div class="line">vec4 Color = texture(sampler2D(uTexture, uSampler), UV);</div>
</div><!-- fragment --><p>Unless your application must support OpenGL, it is strongly recommended to use separate samplers.</p>
<h3><a class="anchor" id="autotoc_md32"></a>
Immutable Samplers</h3>
<p>In many scenarios sampler properties are known and never change. In cases like this it is preferable to use immutable samplers. Immutable samplers are defined when either a pipeline state is created using the <code>ResourceLayout</code> or when a pipeline resource signature is created, e.g.</p>
<div class="fragment"><div class="line">GraphicsPipelineStateCreateInfo PSOCreateInfo;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span>&amp; PSODesc          = PSOCreateInfo.<a class="code hl_variable" href="../../da/d41/structDiligent_1_1PipelineStateCreateInfo.html#a7c216c149f216b75c424c9190cd160ec">PSODesc</a>;</div>
<div class="line"><span class="keyword">auto</span>&amp; GraphicsPipeline = PSOCreateInfo.GraphicsPipeline;</div>
<div class="line"><span class="keyword">auto</span>&amp; ResourceLayout   = GraphicsPipeline.<a class="code hl_variable" href="../../d1/da6/structDiligent_1_1PipelineStateDesc.html#a3182e2848ffbd259e0809d0f0a84e04d">ResourceLayout</a>;</div>
<div class="line"> </div>
<div class="line">ImmutableSamplerDesc ImmutableSamplers[] =</div>
<div class="line">    {</div>
<div class="line">        {SHADER_TYPE_PIXEL, <span class="stringliteral">&quot;g_WrapSampler&quot;</span>,  WrapSamplerDesc},</div>
<div class="line">        {SHADER_TYPE_PIXEL, <span class="stringliteral">&quot;g_ClampSampler&quot;</span>, ClampSamplerDesc}</div>
<div class="line">    };</div>
<div class="line">ResourceLayout.ImmutableSamplers    = ImmutableSamplers;</div>
<div class="line">ResourceLayout.NumImmutableSamplers = _countof(ImmutableSamplers);</div>
<div class="line"> </div>
<div class="line">pDevice-&gt;CreateGraphicsPipelineState(PSOCreateInfo, &amp;pPSO);</div>
<div class="ttc" id="astructDiligent_1_1PipelineStateCreateInfo_html_a7c216c149f216b75c424c9190cd160ec"><div class="ttname"><a href="../../da/d41/structDiligent_1_1PipelineStateCreateInfo.html#a7c216c149f216b75c424c9190cd160ec">Diligent::PipelineStateCreateInfo::PSODesc</a></div><div class="ttdeci">PipelineStateDesc PSODesc</div><div class="ttdoc">Pipeline state description.</div><div class="ttdef"><b>Definition</b> PipelineState.h:702</div></div>
<div class="ttc" id="astructDiligent_1_1PipelineStateDesc_html_a3182e2848ffbd259e0809d0f0a84e04d"><div class="ttname"><a href="../../d1/da6/structDiligent_1_1PipelineStateDesc.html#a3182e2848ffbd259e0809d0f0a84e04d">Diligent::PipelineStateDesc::ResourceLayout</a></div><div class="ttdeci">PipelineResourceLayoutDesc ResourceLayout</div><div class="ttdoc">Pipeline layout description.</div><div class="ttdef"><b>Definition</b> PipelineState.h:614</div></div>
</div><!-- fragment --><div class="fragment"><div class="line">PipelineResourceSignatureDesc PRSDesc;</div>
<div class="line"> </div>
<div class="line">ImmutableSamplerDesc ImmutableSamplers[] =</div>
<div class="line">    {</div>
<div class="line">        {SHADER_TYPE_PIXEL, <span class="stringliteral">&quot;g_WrapSampler&quot;</span>,  WrapSamplerDesc},</div>
<div class="line">        {SHADER_TYPE_PIXEL, <span class="stringliteral">&quot;g_ClampSampler&quot;</span>, ClampSamplerDesc}</div>
<div class="line">    };</div>
<div class="line">PRSDesc.ImmutableSamplers    = ImmutableSamplers;</div>
<div class="line">PRSDesc.NumImmutableSamplers = _countof(ImmutableSamplers);</div>
<div class="line"> </div>
<div class="line">pDevice-&gt;CreatePipelineResourceSignature(PRSDesc, &amp;pPRS);</div>
</div><!-- fragment --><p>In Direct3D12 and Vulkan, immutable samplers have major advantages over regular ones: they are compiled directly into the PSO, generally faster and don't count towards the limit of the total number of samplers available to the application. In Direct3D11 and Metal, immutable samplers are emulated, but from the application point of view their behavior is identical.</p>
<p>It is always recommended to use immutable samplers whenever possible.</p>
<h2><a class="anchor" id="autotoc_md33"></a>
Combined Samplers</h2>
<p>Combined samplers are the only way to sample textures in OpenGL. <a class="el" href="../../d7/dca/namespaceDiligent.html" title="Graphics engine namespace.">Diligent</a> Engine supports emulation of OpenGL-style combined samplers in all backends so that an application targeting OpenGL will also run on other backends without any changes.</p>
<p>In Direct3D11, Direct3D12 and Metal, combined samplers are emulated through texture + sampler pairs. The name of the sampler is obtained by adding a predefined suffix to the texture name (see below), e.g.:</p>
<div class="fragment"><div class="line">Texture2D    g_Texture;</div>
<div class="line">SamplerState g_Texture_sampler;</div>
<div class="line"> </div>
<div class="line">// ...</div>
<div class="line"> </div>
<div class="line">float4 Color = g_Texture.Sample(g_Texture_sampler, UV);</div>
</div><!-- fragment --><p>When combined image samplers are used, samplers are not exposed as shader resources. In particular, even though the shader above contains <code>g_Texture_sampler</code> sampler, it cannot be accessed directly:</p>
<div class="fragment"><div class="line">pPSO-&gt;GetStaticVariableByName(SHADER_TYPE_PIXEL, <span class="stringliteral">&quot;g_StaticTexture_sampler&quot;</span>) <span class="comment">// returns null</span></div>
<div class="line">pSRB-&gt;GetVariableByName(SHADER_TYPE_PIXEL, <span class="stringliteral">&quot;g_MutableTexture_sampler&quot;</span>) <span class="comment">// returns null</span></div>
</div><!-- fragment --><p>Samplers are set in the texture view that is then bound to the texture variable:</p>
<div class="fragment"><div class="line">pTexView-&gt;SetSampler(pSampler);</div>
<div class="line"><span class="comment">// Sets both texture and samplers</span></div>
<div class="line">pPSO-&gt;GetStaticVariableByName(SHADER_TYPE_PIXEL, <span class="stringliteral">&quot;g_StaticTexture&quot;</span>)-&gt;Set(pTexView);</div>
<div class="line">pSRB-&gt;GetVariableByName(SHADER_TYPE_PIXEL, <span class="stringliteral">&quot;g_MutableTexture&quot;</span>)-&gt;Set(pTexView);</div>
</div><!-- fragment --><p>:warning: When combined image samplers are used, a sampler must be set in the view when the view is set to the shader variable.</p>
<p>Note that emulating combined samplers in Direct3D11, Direct3D12 and Metal requires defining separate sampler object for each texture. The number of available samplers is usually significantly smaller compared to the number of available textures.</p>
<h3><a class="anchor" id="autotoc_md34"></a>
Initializing Combined Samplers</h3>
<p>To enable the usage of combined image samplers, an application should set the <code>ShaderCreateInfo::UseCombinedTextureSamplers</code> flag and define the <code>ShaderCreateInfo::CombinedSamplerSuffix</code>. The suffix is used as described below.</p>
<h4><a class="anchor" id="autotoc_md35"></a>
Direct3D11, Direct3D12, Metal</h4>
<p>The suffix is appended to the name of the texture, which gives the sampler name. Every sampler must be combined with some texture. It is an error to have a sampler that is not assigned to any texture, for example:</p>
<div class="fragment"><div class="line">Texture2D    g_Texture;</div>
<div class="line">SamplerState g_Texture_sampler; // Combined with g_Texture</div>
<div class="line"> </div>
<div class="line">SamplerState g_Sampler; // Error - not combined with any texture</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md36"></a>
Vulkan</h4>
<p>Vulkan-style GLSL allows defining both native combined image samplers as well as separate samplers and images. When <code>UseCombinedTextureSamplers</code> flag is set to <code>true</code>, separate samplers and images must follow the same conventions as for Direct3D and Metal. Native combined image samplers may be used directly:</p>
<div class="fragment"><div class="line">uniform texture2D uTexture;</div>
<div class="line">uniform sampler   uTexture_sampler; // Combined with uTexture</div>
<div class="line"> </div>
<div class="line">uniform sampler   uSampler; // Error - not combined with any texture</div>
<div class="line"> </div>
<div class="line">uniform sampler2D uTexture2; // Native combined sampler</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md37"></a>
OpenGL</h4>
<p>There are no separate samplers in OpenGL shaders, and <code>CombinedSamplerSuffix</code> is ignored. <code>UseCombinedTextureSamplers</code> flag must always be set to <code>true</code> when cross-compiling HLSL shaders to GLSL.</p>
<h3><a class="anchor" id="autotoc_md38"></a>
Immutable Samplers</h3>
<p>Immutable samplers are fully supported for combined image samplers with the only difference that texture names must be specified instead of the sampler names:</p>
<div class="fragment"><div class="line">ImmutableSamplerDesc ImmutableSamplers[] =</div>
<div class="line">    {</div>
<div class="line">        {SHADER_TYPE_PIXEL, &quot;g_Texture1&quot;, WrapSamplerDesc},</div>
<div class="line">        {SHADER_TYPE_PIXEL, &quot;g_Texture2&quot;, ClampSamplerDesc}</div>
<div class="line">    };</div>
<div class="line">ResourceLayout.ImmutableSamplers    = ImmutableSamplers;</div>
<div class="line">ResourceLayout.NumImmutableSamplers = _countof(ImmutableSamplers);</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md39"></a>
Pipeline Resource Signatures</h3>
<p>Using combined image samplers with pipeline resource signatures is generally similar: you need to set <code>UseCombinedTextureSamplers</code> member of <code>PipelineResourceSignatureDesc</code> struct to <code>true</code> and define the <code>CombinedSamplerSuffix</code> (or leave its default value <code>"_sampler"</code>):</p>
<div class="fragment"><div class="line">PipelineResourceSignatureDesc PRSDesc;</div>
<div class="line"> </div>
<div class="line">PRSDesc.<a class="code hl_variable" href="../../d9/df5/structDiligent_1_1PipelineResourceSignatureDesc.html#a19675644e153b3309ce0f32c6bbec065">UseCombinedTextureSamplers</a> = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">PipelineResourceDesc Resources[]</div>
<div class="line">{</div>
<div class="line">    {SHADER_TYPE_PIXEL, <span class="stringliteral">&quot;g_Tex2D_Static&quot;</span>, 1, SHADER_RESOURCE_TYPE_TEXTURE_SRV, SHADER_RESOURCE_VARIABLE_TYPE_STATIC},</div>
<div class="line">    {SHADER_TYPE_PIXEL, <span class="stringliteral">&quot;g_Tex2D_Mut&quot;</span>,    1, SHADER_RESOURCE_TYPE_TEXTURE_SRV, SHADER_RESOURCE_VARIABLE_TYPE_MUTABLE},</div>
<div class="line">    {SHADER_TYPE_PIXEL, <span class="stringliteral">&quot;g_Tex2D_Dyn&quot;</span>,    1, SHADER_RESOURCE_TYPE_TEXTURE_SRV, SHADER_RESOURCE_VARIABLE_TYPE_DYNAMIC}</div>
<div class="line">};</div>
<div class="line">PRSDesc.Resources    = Resources;</div>
<div class="line">PRSDesc.NumResources = _countof(Resources);</div>
<div class="line"> </div>
<div class="line">pDevice-&gt;CreatePipelineResourceSignature(PRSDesc, &amp;pPRS);</div>
<div class="ttc" id="astructDiligent_1_1PipelineResourceSignatureDesc_html_a19675644e153b3309ce0f32c6bbec065"><div class="ttname"><a href="../../d9/df5/structDiligent_1_1PipelineResourceSignatureDesc.html#a19675644e153b3309ce0f32c6bbec065">Diligent::PipelineResourceSignatureDesc::UseCombinedTextureSamplers</a></div><div class="ttdeci">Bool UseCombinedTextureSamplers</div><div class="ttdoc">Whether to use combined texture samplers.</div><div class="ttdef"><b>Definition</b> PipelineResourceSignature.h:373</div></div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md40"></a>
PIPELINE_RESOURCE_FLAG_COMBINED_SAMPLER flag</h4>
<p><code>PIPELINE_RESOURCE_FLAG_COMBINED_SAMPLER</code> can be used with the <code>SHADER_RESOURCE_TYPE_TEXTURE_SRV</code> resource to indicate that the resource is a <em>native</em> combined image sampler. Depending on the backend, this flag results in different behavior, as described below.</p>
<p><b>Direct3D11, Direct3D12 and Metal</b></p>
<p>Native combined image samplers are not available in these backends and are emulated. Using <code>PIPELINE_RESOURCE_FLAG_COMBINED_SAMPLER</code> is the same as defining the texture + sampler pair, e.g.</p>
<div class="fragment"><div class="line">PipelineResourceDesc Resources[]</div>
<div class="line">{</div>
<div class="line">    {SHADER_TYPE_PIXEL, <span class="stringliteral">&quot;g_Tex&quot;</span>, 1, SHADER_RESOURCE_TYPE_TEXTURE_SRV,</div>
<div class="line">        SHADER_RESOURCE_VARIABLE_TYPE_STATIC | PIPELINE_RESOURCE_FLAG_COMBINED_SAMPLER}</div>
<div class="line">};</div>
</div><!-- fragment --><p>is the same as defining two resources:</p>
<div class="fragment"><div class="line">PipelineResourceDesc Resources[]</div>
<div class="line">{</div>
<div class="line">    {SHADER_TYPE_PIXEL, <span class="stringliteral">&quot;g_Tex&quot;</span>,         1, SHADER_RESOURCE_TYPE_TEXTURE_SRV, SHADER_RESOURCE_VARIABLE_TYPE_STATIC},</div>
<div class="line">    {SHADER_TYPE_PIXEL, <span class="stringliteral">&quot;g_Tex_sampler&quot;</span>, 1, SHADER_RESOURCE_TYPE_SAMPLER,     SHADER_RESOURCE_VARIABLE_TYPE_STATIC}</div>
<div class="line">};</div>
</div><!-- fragment --><p>The sampler inherits the variable type, array size and texture stages from the texture. Note also that the sampler may be defined explicitly if it is necessary to override some default settings.</p>
<p>Note that in Direct3D and Metal, <code>PIPELINE_RESOURCE_FLAG_COMBINED_SAMPLER</code> requires that <code>UseCombinedTextureSamplers</code> is set to <code>true</code> and that <code>CombinedSamplerSuffix</code> is not null.</p>
<p><b>Vulkan</b></p>
<p>In Vulkan, <code>PIPELINE_RESOURCE_FLAG_COMBINED_SAMPLER</code> defines the native combined image sampler. It may be used together with separate images and samplers, e.g.:</p>
<div class="fragment"><div class="line">PipelineResourceDesc Resources[]</div>
<div class="line">{</div>
<div class="line">    {SHADER_TYPE_PIXEL, <span class="stringliteral">&quot;g_Tex&quot;</span>,         1, SHADER_RESOURCE_TYPE_TEXTURE_SRV, SHADER_RESOURCE_VARIABLE_TYPE_STATIC},</div>
<div class="line">    {SHADER_TYPE_PIXEL, <span class="stringliteral">&quot;g_Tex_sampler&quot;</span>, 1, SHADER_RESOURCE_TYPE_SAMPLER,     SHADER_RESOURCE_VARIABLE_TYPE_STATIC},</div>
<div class="line">    {SHADER_TYPE_PIXEL, <span class="stringliteral">&quot;g_Tex2&quot;</span>,        1, SHADER_RESOURCE_TYPE_TEXTURE_SRV,</div>
<div class="line">        SHADER_RESOURCE_VARIABLE_TYPE_STATIC | PIPELINE_RESOURCE_FLAG_COMBINED_SAMPLER}</div>
<div class="line">};</div>
</div><!-- fragment --><p>Note that Vulkan supports both emulated and native combined image samplers. In the example above, the <code>g_Tex</code> + <code>g_Tex_sampler</code> pair may be accessed as single combined sampler object when <code>UseCombinedTextureSamplers</code> is set to <code>true</code>, or as individual resources when <code>UseCombinedTextureSamplers</code> is set to <code>false</code>. Same is true when resources are defined through the <code>ResourceLayout</code> member of the pipeline description.</p>
<p>:warning: It is an error to define emulated combined image sampler using the <code>PIPELINE_RESOURCE_FLAG_COMBINED_SAMPLER</code> flag in Vulkan. The flag must only be used to indicate native GLSL combined image samplers.</p>
<p><b>OpenGL</b></p>
<p>In OpenGL, all samplers are combined samplers. However, for consistency with Direct3D and Metal, GLSL samplers are exposed without the <code>PIPELINE_RESOURCE_FLAG_COMBINED_SAMPLER</code> flag when cross-compiling from HLSL.</p>
<h4><a class="anchor" id="autotoc_md41"></a>
Universal Combined Sampler Description</h4>
<p><b>HLSL</b></p>
<p>HLSL is the universal shading language in <a class="el" href="../../d7/dca/namespaceDiligent.html" title="Graphics engine namespace.">Diligent</a> Engine that is supported in all backends and on all platforms. Use the following rules to define combined texture samplers in a signature that will work across all backends:</p>
<ul>
<li>Always explicitly define the texture + sampler pair in the list of resources</li>
<li>Do not use the <code>PIPELINE_RESOURCE_FLAG_COMBINED_SAMPLER</code> flag as when compiling HLSL to SPIRV, HLSL textures are converted to separate images, not to combined samplers.</li>
</ul>
<p><b>GLSL</b></p>
<ul>
<li>If you use Vulkan dialect of GLSL, define the texture + sampler pairs for the emulated combined image samplers.</li>
<li>Use <code>PIPELINE_RESOURCE_FLAG_COMBINED_SAMPLER</code> flag for native combined texture samplers.</li>
</ul>
<p><b>MSL</b></p>
<p>Follow the same rules as for HLSL.</p>
<h2><a class="anchor" id="autotoc_md42"></a>
Shader Cross-Compilation Considerations</h2>
<p><a class="el" href="../../d7/dca/namespaceDiligent.html" title="Graphics engine namespace.">Diligent</a> Engine supports multiple ways of shader cross-compilation. Below are some details related to samplers.</p>
<h3><a class="anchor" id="autotoc_md43"></a>
HLSL -&gt; GLSL for OpenGL</h3>
<p>The HLSL texture + sampler pair is converted to combined GLSL sampler under the hood. Note that for consistency with Direct3D and Metal, the texture resource is exposed without the <code>PIPELINE_RESOURCE_FLAG_COMBINED_SAMPLER</code> flag. Note that this flag is used to indicate native combined image sampler in GLSL and is generally not applicable to HLSL.</p>
<h3><a class="anchor" id="autotoc_md44"></a>
HLSL -&gt; SPIRV for Vulkan</h3>
<p>HLSL textures and samplers are converted directly to separate images and separate samplers in SPIRV. <code>UseCombinedTextureSamplers</code> enables emulated combined image samplers similar to Direct3D and Metal.</p>
<h3><a class="anchor" id="autotoc_md45"></a>
HLSL -&gt; MSL for Metal</h3>
<p>HLSL textures and samplers are converted directly to MSL textures and samplers. <code>UseCombinedTextureSamplers</code> enables Direct3D-style emulated combined image samplers.</p>
<h3><a class="anchor" id="autotoc_md46"></a>
GLSL or SPIRV -&gt; MSL for Metal</h3>
<p>Native combined image samplers in GLSL are always converted to texture + sampler pair in MSL. The pairs may then be accessed as separate resources (<code>UseCombinedTextureSamplers</code> is <code>false</code>) or as emulated combined image samplers (<code>UseCombinedTextureSamplers</code> is <code>true</code>). <code>PIPELINE_RESOURCE_FLAG_COMBINED_SAMPLER</code> flag produces the texture + sampler pair that matches the MSL objects.</p>
<h2><a class="anchor" id="autotoc_md47"></a>
Miscellaneous</h2>
<ul>
<li>When a pipeline state is created using the default resource signature (i.e. <code>ppResourceSignatures</code> member of <code>PipelineStateCreateInfo</code> is null), whether to use combined samplers is defined by the values of <code>UseCombinedTextureSamplers</code> member of <code>ShaderCreateInfo</code> of the shaders in the pipeline. It is possible to mix shaders that use combined samplers with ones that don't, in which case some texture+sampler pairs will be accessed as single object, while others will be separate resources. However, if a shader defines a combined sampler suffix, it must match any other suffix used by other shaders. It is an error to mix shaders that use different suffixes in one pipeline.</li>
<li>When a pipeline state is created using the explicit resource signatures (i.e. <code>ppResourceSignatures</code> of <code>PipelineStateCreateInfo</code> is not null), the values of <code>UseCombinedTextureSamplers</code> member of <code>ShaderCreateInfo</code> of the shaders in the pipeline are ignored. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.13.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
      <a href="https://diligentgraphics.com">
        <img class="footer" src="https://github.com/DiligentGraphics/DiligentCore/raw/master/media/diligentgraphics-logo.png" width="99" height="32" alt="Diligent Graphics" />
      </a>
    </li>
  </ul>
</div>
</body>
</html>
