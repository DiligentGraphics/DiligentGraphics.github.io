<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Diligent Engine: Performance Guide</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Diligent Engine
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('de/df9/DiligentCore_doc_PerformanceGuide.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Performance Guide</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="autotoc_md9"></a>
Shader Resource Variables</h2>
<p><a class="el" href="../../d7/dca/namespaceDiligent.html" title="Graphics engine namespace.">Diligent</a> Engine uses three variable types:</p>
<ul>
<li><em>Static</em> variables can be set only once in each pipeline state object or pipeline resource signature. Once bound, the resource can't be changed.</li>
<li><em>Mutable</em> variables can be set only once in each shader resource binding instance. Once bound, the resource can't be changed.</li>
<li><em>Dynamic</em> variables can be bound any number of times.</li>
</ul>
<p>Internally, static and mutable variables are implemented in the same way. Static variable bindings are copied from PSO or Signature to the SRB either when the SRB is created or when <code>IPipelineState::InitializeStaticSRBResources()</code> method is called.</p>
<p>Dynamic variables introduce some overhead every time an SRB is committed (even if no bindings have changed). Prefer static/mutable variables over dynamic ones whenever possible.</p>
<h2><a class="anchor" id="autotoc_md10"></a>
Dynamic Buffers</h2>
<p><code>USAGE_DYNAMIC</code> buffers introduce some overhead in every draw or dispatch command that uses an SRB with dynamic buffers. Note that extra work is performed even if none of the dynamic buffers have been mapped between the commands. If this is the case, an application should use <code>DRAW_FLAG_DYNAMIC_RESOURCE_BUFFERS_INTACT</code> flag to tell the engine that none of the dynamic buffers have been updated between the commands. Note that the first time an SRB is bound, dynamic buffers are properly bound regardless of the <code>DRAW_FLAG_DYNAMIC_RESOURCE_BUFFERS_INTACT</code> flag.</p>
<p>Constant and structured buffers set with <code>IShaderResourceBinding::SetBufferRange</code> method count as dynamic buffers when the specified range does not cover the entire buffer <em>regardless of the buffer usage</em>, unless the variable was created with <code>NO_DYNAMIC_BUFFERS</code> flag. Note that in the latter case, <code>IShaderResourceBinding::SetBufferOffset</code> method can't be used to set dynamic offset. Similar to <code>USAGE_DYNAMIC</code> buffers, if an applications knows that none of the dynamic offsets have changed between the draw calls, it may use <code>DRAW_FLAG_DYNAMIC_RESOURCE_BUFFERS_INTACT</code> flag.</p>
<p>An application should try to use as few dynamic buffers as possible. On some implementations, the number of dynamic buffers that can be used by a PSO may be limited by as few as 8 buffers. If an application knows that no dynamic buffers will be bound to a shader resource variable, it should use the <code>SHADER_VARIABLE_FLAG_NO_DYNAMIC_BUFFERS</code> flag when defining the variables through the PSO layout or <code>PIPELINE_RESOURCE_FLAG_NO_DYNAMIC_BUFFERS</code> when defining the variable through pipeline resource signature. It is an error to bind <code>USAGE_DYNAMIC</code> buffer to a variable that was created with <code>NO_DYNAMIC_BUFFERS</code> flag. Likewise, it is an error to set dynamic offset for such variable.</p>
<p>Try to optimize dynamic buffers usage, but don't strive to avoid them as they are usually the fastest way to upload frequently changing data to the GPU.</p>
<h2><a class="anchor" id="autotoc_md11"></a>
Render pass</h2>
<p>Use <code>IRenderPass</code> for better performance on mobile GPUs, including ARM-based laptops and desktops.</p>
<p>Vulkan backend natively supports render pass subpasses. The subpasses allow rendering multiple passes in on-chip memory without the need to load and store data to the global memory. This is faster, saves memory bandwidth and reduces power consumption.</p>
<p>Metal backend and Vulkan on top of Metal don't natively support subpasses. To leverage the on-chip memory, use <a href="https://developer.apple.com/documentation/metal/gpu_features/understanding_gpu_family_4/about_imageblocks?language=objc">Imageblocks</a>, <a href="https://developer.apple.com/documentation/metal/gpu_features/understanding_gpu_family_4/about_tile_shading?language=objc">Tile shader</a>, and <a href="https://developer.apple.com/documentation/metal/gpu_features/understanding_gpu_family_4/about_raster_order_groups?language=objc">Raster order groups</a>.</p>
<h2><a class="anchor" id="autotoc_md12"></a>
Profilers</h2>
<ul>
<li><a href="https://renderdoc.org/">RenderDoc</a> - Direct3D11/Direct3D12/OpenGL/Vulkan debugging tool</li>
<li><a href="https://developer.nvidia.com/nsight-graphics">NVidia NSight</a> - Vulkan &amp; Direct3D12 profiling and debugging tool for NVidia GPUs</li>
<li><a href="https://gpuopen.com/rgp/">AMD GPU Profiler</a> - Vulkan &amp; Direct3D12 profiling and debugging tool for AMD GPUs</li>
<li><a href="https://devblogs.microsoft.com/pix/download/">Microsoft PIX</a> - Direct3D11/Direct3D12 profiler and debugger</li>
<li><a href="https://developer.apple.com/xcode/">XCode</a> - GPU profiler &amp; debugger for Metal API (including Vulkan on top of Metal)</li>
<li><a href="https://www.arm.com/products/development-tools/graphics/arm-mobile-Studio">ARM Mobile Studio</a> - profiler for Mali GPUs</li>
<li><a href="https://developer.qualcomm.com/software/snapdragon-profiler">Snapdragon Profiler</a> - profiler for Adreno GPUs</li>
<li><a href="https://gpuinspector.dev/">Android GPU Inspector</a> - debugger &amp; profiler by Google</li>
</ul>
<h2><a class="anchor" id="autotoc_md13"></a>
References</h2>
<ul>
<li><a href="https://developer.nvidia.com/dx12-dos-and-donts">DirectX12 Do's And Don'ts</a> by NVidia</li>
<li><a href="https://developer.nvidia.com/blog/vulkan-dos-donts/">Vulkan Do's And Don'ts</a> by NVidia</li>
<li><a href="https://gpuopen.com/performance/">RDNA2 performance guide</a> by AMD</li>
<li><a href="https://developer.arm.com/documentation/101897/0201/Preface">Arm Mali GPU Best Practices Developer Guide Version</a> by ARM</li>
<li><a href="https://www.youtube.com/watch?v=tnR4mExVClY&amp;list=PLKjl7IFAwc4QUTejaX2vpIwXstbgf8Ik7">Arm Mali GPU Training Series</a> video by ARM</li>
<li><a href="https://developer.qualcomm.com/sites/default/files/docs/adreno-gpu/developer-guide//gpu/gpu.html">Adreno GPU</a> by Qualcomm</li>
<li><a href="http://cdn.imgtec.com/sdk-documentation/PowerVR_Performance_Recommendations.pdf">PowerVR</a> by Imagination Technologies</li>
<li><a href="https://developer.apple.com/library/archive/documentation/3DDrawing/Conceptual/MTLBestPracticesGuide/index.html">Metal Best Practices Guide</a> by Apple</li>
<li><a href="https://developer.apple.com/videos/graphics-games">Apple Tech Talks - Graphics &amp; Games</a></li>
<li><a href="https://edw.is/renderdoc-webgl/">How to capture WebGL with Renderdoc</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.13.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
      <a href="https://diligentgraphics.com">
        <img class="footer" src="https://github.com/DiligentGraphics/DiligentCore/raw/master/media/diligentgraphics-logo.png" width="99" height="32" alt="Diligent Graphics" />
      </a>
    </li>
  </ul>
</div>
</body>
</html>
